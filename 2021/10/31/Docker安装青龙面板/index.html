<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible"><meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1,user-scalable=no"><meta name="renderer" content="webkit"><meta name="color-scheme" content="dark light"><meta name="author" content="ainexur"><meta name="description" content="温故 知新"><meta name="keywords" content="博客"><title>Docker之qinglong</title><link rel="icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="//at.alicdn.com/t/font_3242539_utq6ykfq7z.css"><link rel="stylesheet" light-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/default.min.css" dark-src="https://cdn.staticfile.org/highlight.js/11.5.0/styles/tokyo-night-dark.min.css"><link rel="stylesheet" href="https://fonts.font.im/css?family=Noto+Serif" as="font"><link href="/style/index.css" rel="stylesheet"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="寻人启事" type="application/atom+xml">
</head><body><header class="page-header"><nav><ul class="router-list"><li class="nav-item"> <a href="/">主页</a></li><li class="nav-item"> <a href="/archives/">归档</a></li><li class="nav-item"> <a href="/atom.xml">RSS</a></li></ul><div class="mode-switch"><span class="iconfont icon-DarkTheme"></span></div></nav></header><main><section class="main-content"><section class="post-page"><div class="title-bar"><h1>Docker之qinglong</h1><div class="post-info"><span>2021-10-31 02:13:08</span><span class="tags"><a href="/tags/CentOS7/">#CentOS7</a></span></div></div><article> <div class="content"><h2 id="1-前提条件"><a href="#1-前提条件" class="headerlink" title="1. 前提条件"></a>1. 前提条件</h2><p>安装了docker</p>
<h2 id="2-青龙面板安装"><a href="#2-青龙面板安装" class="headerlink" title="2.青龙面板安装"></a>2.青龙面板安装</h2><h3 id="拉取青龙的镜像文件（官方）"><a href="#拉取青龙的镜像文件（官方）" class="headerlink" title="拉取青龙的镜像文件（官方）"></a>拉取青龙的镜像文件（官方）</h3><pre><code class="hljs plaintext">docker pull whyour/qinglong:latest</code></pre>

<h3 id="创建容器qinglong-ninjia"><a href="#创建容器qinglong-ninjia" class="headerlink" title="创建容器qinglong + ninjia"></a>创建容器qinglong + ninjia</h3><pre><code class="hljs shell">docker run -dit \
  -v $PWD/ql/config:/ql/config \
  -v $PWD/ql/log:/ql/log \
  -v $PWD/ql/db:/ql/db \
  -v $PWD/ql/repo:/ql/repo \
  -v $PWD/ql/raw:/ql/raw \
  -v $PWD/ql/scripts:/ql/scripts \
  -v $PWD/ql/jbot:/ql/jbot \
  -v $PWD/ql/ninja:/ql/ninja \
  -p 5700:5700 \
  -p 5701:5701 \
  --name qinglong \
  --hostname qinglong \
  --restart unless-stopped \
  whyour/qinglong:latest</code></pre>

<p>进入qinglong bash</p>
<pre><code class="hljs shell">docker exec -it qinglong bash</code></pre>

<p>执行</p>
<pre><code class="hljs shell">git clone https://ghproxy.com//https://github.com/showmexlq/Waikiki_ninja /ql/ninja
cd /ql/ninja/backend
pnpm install
cp .env.example .env # 如有需要, 修改.env
pm2 start
cp sendNotify.js /ql/data/scripts/sendNotify.js</code></pre>

<p>将以下内容粘贴到 <code>extra.sh</code>（重启后自动更新并启动 Ninja）</p>
<pre><code class="hljs shell">cd /ql/ninja/backend
git checkout .
git pull
pnpm install
pm2 start
cp sendNotify.js /ql/data/scripts/sendNotify.js</code></pre>



<h3 id="定时任务："><a href="#定时任务：" class="headerlink" title="定时任务："></a>定时任务：</h3><pre><code class="hljs shell">GithubProxyUrl=&quot;https://git.metauniverse-cn.com/&quot;
ql repo https://github.com/KingRan/KR.git &quot;jd_|jx_|jdCookie&quot; &quot;activity|backUp&quot; &quot;^jd[^_]|USER|utils|function|sign|sendNotify|ql|JDJR&quot;</code></pre>

<p>账号列表：</p>
<pre><code class="hljs shell">cat /ql/config/auth.json</code></pre>

<h2 id="内置命令"><a href="#内置命令" class="headerlink" title="内置命令"></a>内置命令</h2><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">更新并重启青龙</span>
ql update                                                    
<span class="hljs-meta prompt_"># </span><span class="language-bash">运行自定义脚本extra.sh</span>
ql extra                                                     
<span class="hljs-meta prompt_"># </span><span class="language-bash">添加单个脚本文件</span>
ql raw &lt;file_url&gt;                                             
<span class="hljs-meta prompt_"># </span><span class="language-bash">添加单个仓库的指定脚本</span>
ql repo &lt;repo_url&gt; &lt;whitelist&gt; &lt;blacklist&gt; &lt;dependence&gt; &lt;branch&gt;   
<span class="hljs-meta prompt_"># </span><span class="language-bash">删除旧日志</span>
ql rmlog &lt;days&gt;                                              
<span class="hljs-meta prompt_"># </span><span class="language-bash">启动tg-bot</span>
ql bot                                                       
<span class="hljs-meta prompt_"># </span><span class="language-bash">检测青龙环境并修复</span>
ql check                                                     
<span class="hljs-meta prompt_"># </span><span class="language-bash">重置登录错误次数</span>
ql resetlet                                                  
<span class="hljs-meta prompt_"># </span><span class="language-bash">禁用两步登录</span>
ql resettfa                                                  
<span class="hljs-meta prompt_"></span>
<span class="hljs-meta prompt_"># </span><span class="language-bash">依次执行，如果设置了随机延迟，将随机延迟一定秒数</span>
task &lt;file_path&gt;                                             
<span class="hljs-meta prompt_"># </span><span class="language-bash">依次执行，无论是否设置了随机延迟，均立即运行，前台会输出日，同时记录在日志文件中</span>
task &lt;file_path&gt; now                                         
<span class="hljs-meta prompt_"># </span><span class="language-bash">并发执行，无论是否设置了随机延迟，均立即运行，前台不产生日，直接记录在日志文件中，且可指定账号执行</span>
task &lt;file_path&gt; conc &lt;env_name&gt; &lt;account_number&gt;(可选的) 
<span class="hljs-meta prompt_"># </span><span class="language-bash">指定账号执行，无论是否设置了随机延迟，均立即运行</span> 
task &lt;file_path&gt; desi &lt;env_name&gt; &lt;account_number&gt;</code></pre>

<h2 id="开发"><a href="#开发" class="headerlink" title="开发"></a>开发</h2><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">git <span class="hljs-built_in">clone</span> git@github.com:whyour/qinglong.git</span>
<span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cd</span> qinglong</span>
<span class="hljs-meta prompt_">$ </span><span class="language-bash"><span class="hljs-built_in">cp</span> .env.example .<span class="hljs-built_in">env</span></span>
<span class="hljs-meta prompt_">$ </span><span class="language-bash">yarn install</span>
<span class="hljs-meta prompt_">$ </span><span class="language-bash">yarn start</span></code></pre>

<h2 id="交流"><a href="#交流" class="headerlink" title="交流"></a>交流</h2><p><a href="https://gitee.com/link?target=https://t.me/jiao_long">telegram频道</a></p>
<h2 id="常用操作"><a href="#常用操作" class="headerlink" title="常用操作"></a>常用操作</h2><pre><code class="hljs shell">sudo docker images # 查看镜像列表
sudo docker ps -a #查看容器列表
</code></pre>



<pre><code class="hljs shell">docker run -d \
 --name jellyfin \
 --user uid:gid \
 --net=host \
 --volume ~/lenovo120g/jellyfin/config:/config \
 --volume ~/lenovo120g/jellyfin/cache:/cache \
 --mount type=bind,source=~/lenovo120g/jellyfin/media,target=/media \
 --restart=unless-stopped \
 jellyfin/jellyfin
 
 sudo docker run -d \
 --name jellyfin \
 --user 0:0\
 --net=host \
 --volume /jellyfin/config:/config \
 --volume /jellyfin/cache:/cache \
 --restart=unless-stopped \
 jellyfin/jellyfin</code></pre>

</div></article><div class="copyright-wrapper"><p>原文作者:<a href="https://ainexur.github.io">ainexur</a></p><p>原文链接:<a href="https://ainexur.github.io/2021/10/31/Docker%E5%AE%89%E8%A3%85%E9%9D%92%E9%BE%99%E9%9D%A2%E6%9D%BF/">Docker之qinglong</a></p><p>发表日期: 2021-10-31 02:13:08</p><p>更新日期: 2023-04-02 23:52:57</p><p>版权声明: 本文采用<a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p></div><div class="post-pager"><div class="prev"><a href="/2021/11/27/MySQL%E5%9F%BA%E7%A1%80/" title="MySQL基础">上一篇 MySQL基础</a></div><div class="next"> <a href="/2021/10/31/CentOS7%E6%9B%B4%E6%8D%A2%E5%9B%BD%E5%86%85%E6%BA%90/" title="CentOS7更换国内源">下一篇 CentOS7更换国内源</a></div></div><link rel="stylesheet" href="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.css"/><script src="https://cdn.staticfile.org/gitalk/1.7.2/gitalk.min.js"></script><div id="gitalk-container"></div><script>new Gitalk({
  clientID: '',
  clientSecret: '',
  repo: '',
  owner: '',
  admin: '',
  id: location.pathname.substr(0, 48),
  distractionFreeMode: true,
  labels: ['Gitalk'],
  title: 'Docker之qinglong',
}).render('gitalk-container');</script></section></section></main><footer class="footer-page"><div><span>Powered by</span><a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a><span>| Theme</span><a target="_blank" rel="noopener" href="https://github.com/techmovie/hexo-theme-instapaper">instapaper</a></div></footer><script src="/scripts/dark.js"></script><script src="/scripts/post.js"></script></body></html>